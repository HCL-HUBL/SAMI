%%{init: {'themeVariables': { 'edgeLabelBackground': '#ffffff'}}}%%
flowchart TD
    classDef node fill:#56B4E9,stroke:#333,stroke-width:1px;
    
    umitools([UMI-tools]) -."FASTQ ğŸ”".-> cutadapt(["cutadapt ğŸ”"])
    cutadapt -."FASTQ ğŸ”".-> STAR1(["STAR pass 1 ğŸ”"])
    STAR1 ==All sample junctions==> STARi([STAR index])
    STAR1 -.BAM.-> fgbio(["fgbio consensus ğŸ”"])
    fgbio -.FASTQ.-> STAR2(["STAR pass 2 ğŸ”"])
    STARi -.-> STAR2
    STAR1 -.Unaligned reads.-> merge([Merge])
    STAR2 -.Aligned reads.-> merge
    STAR2 ==All sample junctions==> splicing([Splicing analysis])
    merge -."BAM".-> featureCounts(["featureCounts + edgeR ğŸ”"])
    merge -."BAM".-> rnaSeqMetrics(["ğŸ”ğŸ”ğŸ”"])
